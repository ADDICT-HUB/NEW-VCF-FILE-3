<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ğ†ğ”ğ‘ğ” ğ•.ğ‚.ğ… 3</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- Top subtle animated background -->
  <div class="page-bg" aria-hidden="true"></div>

  <!-- 3D Neon Glowing Blobs -->
  <div class="glow-container" aria-hidden="true">
    <div class="glow-blob" style="--size:180px; --x:10%; --y:20%; --color:maroon;"></div>
    <div class="glow-blob" style="--size:120px; --x:70%; --y:25%; --color:black;"></div>
    <div class="glow-blob" style="--size:150px; --x:40%; --y:70%; --color:white;"></div>
  </div>

  <!-- Header glass card -->
  <header class="glass-card header-card" role="banner">
    <div class="brand">ğ†ğ”ğ‘ğ” ğ•.ğ‚.ğ… 3</div>
    <div class="subtitle">ğğğ° ğğ«ğ¨ğ© â€¢ ğ‚ğ¥ğğšğ§ â€¢ ğ’ğğœğ®ğ«ğ</div>
  </header>

  <!-- Counters glass card -->
  <section class="glass-card counters-card" aria-label="progress counters">
    <div class="counter">
      <div class="label-row">
        <span class="label">Registered</span>
        <span class="num" id="regCount">0</span>
      </div>
      <div class="double-track">
        <div class="outer-track"></div>
        <div id="regFill" class="inner-fill reg"></div>
      </div>
    </div>

    <div class="counter">
      <div class="label-row">
        <span class="label">Remaining</span>
        <span class="num" id="remCount">800</span>
      </div>
      <div class="double-track">
        <div class="outer-track"></div>
        <div id="remFill" class="inner-fill rem"></div>
      </div>
    </div>

    <div class="counter">
      <div class="label-row">
        <span class="label">Target</span>
        <span class="num" id="tarCount">800</span>
      </div>
      <div class="double-track">
        <div class="outer-track"></div>
        <div id="tarFill" class="inner-fill tar"></div>
      </div>
    </div>
  </section>

  <!-- Form glass card -->
  <main class="glass-card form-card" role="main">
    <form id="vcfForm" class="vcf-form" autocomplete="off" novalidate>
      <label class="sr-only" for="name">Full name</label>
      <input id="name" name="name" type="text" placeholder="Full name" required />

      <label class="sr-only" for="phone">Phone</label>
      <input id="phone" name="phone" type="tel" placeholder="Phone (any country, digits only)" required />

      <div class="form-actions">
        <button type="button" id="contactBtn" class="btn contact">Contact Admin</button>
        <button type="submit" id="submitBtn" class="btn submit">Submit</button>
      </div>

      <div id="formMsg" class="form-msg" aria-live="polite"></div>
    </form>
  </main>

  <!-- Footer -->
  <footer class="glass-card footer-card" role="contentinfo">
    <small>Â© 2025 Guru Tech Lab â€” VCF Wildery (Target = 800)</small>
  </footer>

  <!-- Background music -->
  <audio id="bgMusic" loop>
    <source src="https://files.catbox.moe/ets3nu.mp3" type="audio/mpeg">
    Your browser does not support the audio element.
  </audio>

  <!-- Scripts -->
  <script src="script.js"></script>
  <script>
    const music = document.getElementById('bgMusic');
    const form = document.getElementById('vcfForm');
    const formMsg = document.getElementById('formMsg');
    const contactBtn = document.getElementById('contactBtn');

    // Start music on first interaction
    function startMusic() {
      music.play().catch(err => console.log('Autoplay blocked:', err));
      document.body.removeEventListener('touchstart', startMusic);
      document.body.removeEventListener('click', startMusic);
    }
    document.body.addEventListener('touchstart', startMusic, { once: true });
    document.body.addEventListener('click', startMusic, { once: true });

    // Contact admin button
    contactBtn.addEventListener('click', () => {
      window.location.href = 'https://wa.me/254735403829';
    });

    // Form submission
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      const phone = document.getElementById('phone').value.trim();

      // Validate inputs
      if (!name) { formMsg.textContent = 'Please enter your name.'; return; }
      if (!/^\d{6,15}$/.test(phone)) { formMsg.textContent = 'Enter a valid phone number.'; return; }

      // Prevent duplicate in localStorage
      let db = JSON.parse(localStorage.getItem('vcf_wildery_db') || '{"entries":[]}');
      if (db.entries.some(e => e.phone === phone)) {
        formMsg.textContent = 'This phone number is already registered.';
        return;
      }

      // Save locally (fallback)
      db.entries.push({ name, phone, at: new Date().toISOString() });
      db.registered = db.entries.length;
      db.target = 800;
      localStorage.setItem('vcf_wildery_db', JSON.stringify(db));

      // Refresh UI
      document.getElementById('regCount').textContent = db.registered;
      document.getElementById('remCount').textContent = Math.max(0, db.target - db.registered);
      document.getElementById('regFill').style.width = Math.round((db.registered/db.target)*100) + '%';
      document.getElementById('remFill').style.width = Math.round(((db.target - db.registered)/db.target)*100) + '%';

      // Reset form and redirect
      form.reset();
      formMsg.textContent = 'Registration received. Redirecting...';
      setTimeout(() => {
        window.location.href = 'https://whatsapp.com/channel/0029VbBNUAFFXUuUmJdrkj1f';
      }, 1000); // slight delay so message shows
    });
  </script>

</body>
</html>
